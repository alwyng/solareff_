<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <meta name="msapplication-tap-highlight" content="no" />
		<title>Solareff</title>
	</head>
<body onload="load()">
	    <div class="statusbar-overlay">    	
	    </div>
	    <div class="views">
	      <div class="view view-main">
	        <div class="navbar">
	          <div class="navbar-inner">
	        	<div class="left sliding"><a href="main.html" class="back link"><i class="icon icon-back"></i><span>Back</span></a></div>	            	
	            <div class="center sliding">
	            	Submission
				</div>
	            <div class="right sliding">
	   				<form class="center" name="frmKwh" action="">
						<input size="9" class="kwhstyle" type="text" name="txtKwh" disabled>
					</form>
	            </div>
	          </div>
	        </div>
	        <div class="pages navbar-through toolbar-through">
          		<div class="page">
            		<div class="page-content">
						<div class="app">
						<a href="http://www.solareff.co.za">
							<img style='width:100%;height:100%;object-fit: contain;' src="../img/logo.jpg">
						</a>  
						<!--<form class="center" name="frmKwh" action="">
							<input type="text" name="txtKwh" disabled>
						</form>-->
						<h3 style="padding-left:2%;">Submit to Solareff</h3>
						<!--<a href="main.html">
							<input type="button" name="btnBack" value="Back">
						</a>-->
						<script type="text/javascript" src="../cordova.js"></script>
						<script type="text/javascript" src="../js/index.js"></script>
						
						<div style="padding-left:2%;">
							<script>
								/*var arrRoomList = localStorage.roomList.split(';');
								var strEmailBody = 'Room,Quantity,Number Items\n';
								var arrRoomDetail;
								var arrAppDetail;
								for (var i=0;i<arrRoomList.length;i++) {
									arrRoomDetail = localStorage.getItem(arrRoomList[i]).split(';');
									for (var j=0;j<arrRoomDetail.length;j++) {
										if (arrRoomDetail[j]!="") {
											arrAppDetail = arrRoomDetail[j].split(',');
											if (j==0) {
												document.write("<br>");
												document.write(arrRoomList[i]+" <br>");
												document.write("&nbsp&nbsp&nbsp"+arrAppDetail[0]+"\t"+"Hours="+arrAppDetail[1]+"\t Quantity="+arrAppDetail[2])+" <br>";
												document.write("<br>");
											} else {
												document.write("&nbsp&nbsp&nbsp"+arrAppDetail[0]+"\t"+"Hours="+arrAppDetail[1]+"\t Quantity="+arrAppDetail[2])+" <br>";
												document.write("<br>");
											}
										}
									}
								}*/
								
								var arrRoomList = localStorage.roomList.split(';');
								var strEmailBody = '<table><tr><td>Room/Appliance</td><td>Quantity</td><td>Number Items</td></tr>';
								var arrRoomDetail;
								
								for (var i=0;i<arrRoomList.length;i++) {
									
									var roomList = localStorage.getItem(arrRoomList[i]);
									if (roomList!=null) {
										arrRoomDetail = roomList.split(';');
										strEmailBody += '<tr><td> '+arrRoomList[i]+' </td></tr><tr>';
										for (var j=0;j<arrRoomDetail.length;j++) {
											if (arrRoomDetail[j]!="") {
												var appDetail = arrRoomDetail[j].split(',');
												if (appDetail[1]!='' && appDetail[2]!='') {
													strEmailBody += '<tr><td> '+appDetail[0]+' </td><td> '+appDetail[1]+' </td><td> '+appDetail[2]+' </td></tr>';
												}
											}
										}
										strEmailBody += '</tr>';
									}
								}
								strEmailBody += '</table>';
								//alert(strEmailBody);
								document.write(strEmailBody);
								
								
								
								
								
								
							</script>
						</div>
						<br>
						<div style="height: 5%; width: 100%; box-sizing: border-box; padding-left:10%;; padding-right:10%;">									
							<input class="button button-fill" type="button" name="btnSubmit" onclick="capturePhoto();" value="Take photo and submit information">
						</div>
						<br>		
						</div>				
									</div>
								</div>
							</div>
							<div class="toolbar">
								<div class="toolbar-inner">
									<a href="contact_us.html" class="link">Contact Us
									</a>
									<a href="faq.html" class="link">FAQ
									</a>
								</div>
							</div>			
	       </div>
	      </div>	          	    

		<script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>

        <script type="text/javascript">
            app.initialize();
        </script>

		<script type="text/javascript">
            var dialog;

            showToast = function (text) {
                text = text == null ? 'finished or canceled' : text;

                setTimeout(function () {
                    if (window.Windows !== undefined) {
                        showWinDialog(text);
                    } else
                    if (window.plugins && window.plugins.toast) {
                        window.plugins.toast.showShortBottom(String(text));
                    }
                    else {
                        alert(text);
                    }
                }, 100);
            };

            document.addEventListener('deviceready', function () {
                if (device.platform == 'windows') {
                    window.alert = function (msg) {
                        new Windows.UI.Popups.MessageDialog(msg).showAsync();
                    };
                }
            }, false);
			
            chooseAttachment = function (source) {

                if (device.platform == 'Win32NT') {
                    alert('Not supported on WP8.0 and WP8.1 Silverlight!');
                    return;
                }

                var options = {
                    destinationType: Camera.DestinationType.FILE_URI,
                    sourceType: source === undefined ? Camera.PictureSourceType.CAMERA : source
                };

                var failure = function () {
                    if (source === undefined)
                        chooseAttachment(Camera.PictureSourceType.PHOTOLIBRARY);
                };

                navigator.camera.getPicture(function(uri) {
                    var fn = function () {
                            cordova.plugins.email.open({
                                subject: 'Attachment from file system',
                                body: uri,
                                attachments: uri
                            }, showToast);
                        };

                    setTimeout(fn, 500);
                }, failure, options);
            };
		</script>
</body>